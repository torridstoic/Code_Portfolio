DROP TABLE IF EXISTS Wallets;
DROP TABLE IF EXISTS RecurringBudgets;
DROP TABLE IF EXISTS RecurringTransactions;
DROP TABLE IF EXISTS Users;
DROP TABLE IF EXISTS Stores;
DROP TABLE IF EXISTS Budgets;
DROP TABLE IF EXISTS WalletTypes;
DROP TABLE IF EXISTS Transactions;
DROP TABLE IF EXISTS Savings;
DROP TABLE IF EXISTS TransactionTypes;

CREATE TABLE TransactionTypes(
    Id INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT, 
    Type TEXT NOT NULL
);

CREATE TABLE WalletTypes(
    Id INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT, 
    Type TEXT NOT NULL
);

CREATE TABLE Stores(
    Id INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT, 
    Name TEXT NOT NULL,
	ColorArgb INTEGER
);

CREATE TABLE Users(
    Id INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT, 
	Username Text NOT NULL UNIQUE, 
    FirstName TEXT NOT NULL, 
    LastName TEXT NOT NULL, 
    Email TEXT UNIQUE, 
    Password TEXT NOT NULL, 
    LastLogin INTEGER NOT NULL DEFAULT 0
);

CREATE TABLE Wallets(
    Id INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT, 
    UserId INTEGER NOT NULL, 
	WalletTypeId INTERGER NOT NULL DEFAULT 1,
    Name TEXT NOT NULL, 
	ColorArgb INTEGER,
    BudgetTotal NUMERIC NOT NULL DEFAULT 0, 
    Interval INTEGER NOT NULL DEFAULT 0, 
    FOREIGN KEY(UserId) REFERENCES Users(Id)
	FOREIGN KEY(WalletTypeId) REFERENCES WalletTypes(Id) 
);

CREATE TABLE Transactions(
    Id INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT, 
    WalletId INTEGER NOT NULL, 
    StoreId TEXT NOT NULL, 
	TransactionTypeId INTEGER NOT NULL DEFAULT 0,
    Amount NUMERIC NOT NULL DEFAULT 0,
    Created NUMERIC NOT NULL, 
    Notes TEXT,
    Flagged NUMERIC NOT NULL DEFAULT 0,
	Posted NUMERIC NOT NULL DEFAULT 0,
    FOREIGN KEY(WalletId) REFERENCES Wallets(Id)
    FOREIGN KEY(StoreId) REFERENCES Stores(Id) 
	FOREIGN KEY(TransactionTypeId) REFERENCES TransactionTypes(Id) 
);

CREATE TABLE Budgets(
	Id INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT, 
	WalletId INTEGER NOT NULL,
	Amount NUMERIC NOT NULL,
	StartDate NUMERIC NOT NULL,
	EndDate NUMERIC NOT NULL,
	FOREIGN KEY(WalletId) REFERENCES Wallets(Id)
);

CREATE TABLE RecurringTransactions( 
	Id INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT,
	WalletId INTEGER NOT NULL,
	StoreId INTEGER NOT NULL,
	TransactionTypeId INTEGER NOT NULL DEFAULT 0,
	Amount NUMERIC NOT NULL,
	ProcessDate NUMERIC NOT NULL,
	ProcessPeriod INTEGER NOT NULL,
	IsPositive NUMERIC NOT NULL DEFAULT 0,
	FOREIGN KEY(WalletId) REFERENCES Wallets(Id)
	FOREIGN KEY(StoreId) REFERENCES Stores(Id)
	FOREIGN KEY(TransactionTypeId) REFERENCES TransactionTypes(Id) 
);

CREATE TABLE RecurringBudgets(
	Id INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT,
	WalletId INTEGER NOT NULL,
	Amount INTEGER NOT NULL,
	Period INTEGER NOT NULL,
	CurrentStartDate NUMERIC NOT NULL,
	CurrentEndDate NUMERIC NOT NULL,
	FOREIGN KEY(WalletId) REFERENCES Wallets(Id)
);

INSERT INTO WalletTypes (Id, Type) VALUES (1, "Default");
INSERT INTO WalletTypes (Id, Type) Values (2, "Savings");
INSERT INTO TransactionTypes (Id, Type) VALUES (0, "Unknown")
INSERT INTO TransactionTypes (Id, Type) VALUES (1, "Payments")
INSERT INTO TransactionTypes (Id, Type) VALUES (2, "Credits")
INSERT INTO TransactionTypes (Id, Type) VALUES (3, "Savings")